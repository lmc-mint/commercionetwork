<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>KMS with YubiHSM2 | Commercio.network Documentation</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="Documentation for the Commercio.network blockchain.">
    
    <link rel="preload" href="/assets/css/0.styles.a31c27c1.css" as="style"><link rel="preload" href="/assets/js/app.25897520.js" as="script"><link rel="preload" href="/assets/js/2.ac32ef9e.js" as="script"><link rel="preload" href="/assets/js/1.da52573b.js" as="script"><link rel="preload" href="/assets/js/29.c7d75f04.js" as="script"><link rel="prefetch" href="/assets/js/10.8225404c.js"><link rel="prefetch" href="/assets/js/100.167014a9.js"><link rel="prefetch" href="/assets/js/101.3065d56d.js"><link rel="prefetch" href="/assets/js/102.27e5ed65.js"><link rel="prefetch" href="/assets/js/103.a1dd6497.js"><link rel="prefetch" href="/assets/js/104.8069582e.js"><link rel="prefetch" href="/assets/js/105.fef5cde4.js"><link rel="prefetch" href="/assets/js/106.b9afe399.js"><link rel="prefetch" href="/assets/js/107.37bce772.js"><link rel="prefetch" href="/assets/js/108.d1d6e5d1.js"><link rel="prefetch" href="/assets/js/109.73662b0f.js"><link rel="prefetch" href="/assets/js/11.b7d42d3c.js"><link rel="prefetch" href="/assets/js/110.c4888756.js"><link rel="prefetch" href="/assets/js/111.abbd096a.js"><link rel="prefetch" href="/assets/js/112.4e153d93.js"><link rel="prefetch" href="/assets/js/113.bfc46b3a.js"><link rel="prefetch" href="/assets/js/114.7288b92c.js"><link rel="prefetch" href="/assets/js/115.09ef338c.js"><link rel="prefetch" href="/assets/js/116.1f8bfded.js"><link rel="prefetch" href="/assets/js/117.be07720c.js"><link rel="prefetch" href="/assets/js/118.6f04dd1b.js"><link rel="prefetch" href="/assets/js/119.a8151902.js"><link rel="prefetch" href="/assets/js/12.63c1f64f.js"><link rel="prefetch" href="/assets/js/120.86479b3b.js"><link rel="prefetch" href="/assets/js/121.ff91cae0.js"><link rel="prefetch" href="/assets/js/122.f0bce998.js"><link rel="prefetch" href="/assets/js/123.9ce8c71b.js"><link rel="prefetch" href="/assets/js/124.1e91587a.js"><link rel="prefetch" href="/assets/js/125.d3886915.js"><link rel="prefetch" href="/assets/js/126.91771e3d.js"><link rel="prefetch" href="/assets/js/127.1db29e58.js"><link rel="prefetch" href="/assets/js/128.433043c8.js"><link rel="prefetch" href="/assets/js/129.e37001f4.js"><link rel="prefetch" href="/assets/js/13.aed2da28.js"><link rel="prefetch" href="/assets/js/130.23ba8a5e.js"><link rel="prefetch" href="/assets/js/131.017de9d5.js"><link rel="prefetch" href="/assets/js/132.bb40e4c1.js"><link rel="prefetch" href="/assets/js/133.f955cda5.js"><link rel="prefetch" href="/assets/js/134.c7c6bb5c.js"><link rel="prefetch" href="/assets/js/135.ab832ac0.js"><link rel="prefetch" href="/assets/js/136.9675ca32.js"><link rel="prefetch" href="/assets/js/137.d45e629a.js"><link rel="prefetch" href="/assets/js/138.c094930d.js"><link rel="prefetch" href="/assets/js/139.a9e2cbcd.js"><link rel="prefetch" href="/assets/js/14.7a8ad4bd.js"><link rel="prefetch" href="/assets/js/140.bf6e4e6a.js"><link rel="prefetch" href="/assets/js/141.b6cabec2.js"><link rel="prefetch" href="/assets/js/142.dd4c6d7c.js"><link rel="prefetch" href="/assets/js/143.6ea6f7a6.js"><link rel="prefetch" href="/assets/js/144.65307785.js"><link rel="prefetch" href="/assets/js/145.2a9e641e.js"><link rel="prefetch" href="/assets/js/146.61ee5da0.js"><link rel="prefetch" href="/assets/js/147.c4d81026.js"><link rel="prefetch" href="/assets/js/148.e4f95d58.js"><link rel="prefetch" href="/assets/js/149.b904d701.js"><link rel="prefetch" href="/assets/js/15.ef3206c2.js"><link rel="prefetch" href="/assets/js/150.db100444.js"><link rel="prefetch" href="/assets/js/151.7c4871d7.js"><link rel="prefetch" href="/assets/js/152.daec42cb.js"><link rel="prefetch" href="/assets/js/153.0e2e26a4.js"><link rel="prefetch" href="/assets/js/154.b1ace3fb.js"><link rel="prefetch" href="/assets/js/155.ef8a1c8f.js"><link rel="prefetch" href="/assets/js/156.a5fd8779.js"><link rel="prefetch" href="/assets/js/157.b536bbee.js"><link rel="prefetch" href="/assets/js/158.75d82d5b.js"><link rel="prefetch" href="/assets/js/159.4a209a59.js"><link rel="prefetch" href="/assets/js/16.a8d4284c.js"><link rel="prefetch" href="/assets/js/160.0b3adc35.js"><link rel="prefetch" href="/assets/js/161.9a7e62d5.js"><link rel="prefetch" href="/assets/js/162.a6e5f565.js"><link rel="prefetch" href="/assets/js/163.ca687162.js"><link rel="prefetch" href="/assets/js/164.df453190.js"><link rel="prefetch" href="/assets/js/165.22cad993.js"><link rel="prefetch" href="/assets/js/166.3a5ab4e0.js"><link rel="prefetch" href="/assets/js/167.a768e87e.js"><link rel="prefetch" href="/assets/js/168.e28f9615.js"><link rel="prefetch" href="/assets/js/169.98e83c13.js"><link rel="prefetch" href="/assets/js/17.4c496ef5.js"><link rel="prefetch" href="/assets/js/170.8caf3b66.js"><link rel="prefetch" href="/assets/js/171.99120951.js"><link rel="prefetch" href="/assets/js/172.299fa75e.js"><link rel="prefetch" href="/assets/js/173.4b585278.js"><link rel="prefetch" href="/assets/js/174.5ac924a5.js"><link rel="prefetch" href="/assets/js/175.33878379.js"><link rel="prefetch" href="/assets/js/176.5855aa4d.js"><link rel="prefetch" href="/assets/js/177.abc2d5be.js"><link rel="prefetch" href="/assets/js/178.802e3784.js"><link rel="prefetch" href="/assets/js/179.ba4a65cf.js"><link rel="prefetch" href="/assets/js/18.74f5b65e.js"><link rel="prefetch" href="/assets/js/180.8e5e7e6f.js"><link rel="prefetch" href="/assets/js/181.819a68c7.js"><link rel="prefetch" href="/assets/js/182.8f1433ed.js"><link rel="prefetch" href="/assets/js/183.7a508871.js"><link rel="prefetch" href="/assets/js/184.4087e31b.js"><link rel="prefetch" href="/assets/js/185.73cac2ab.js"><link rel="prefetch" href="/assets/js/186.abde81d3.js"><link rel="prefetch" href="/assets/js/187.16e465f0.js"><link rel="prefetch" href="/assets/js/188.932c9f4a.js"><link rel="prefetch" href="/assets/js/189.e1fc9e75.js"><link rel="prefetch" href="/assets/js/19.1c8ab2a5.js"><link rel="prefetch" href="/assets/js/190.ca1e0af6.js"><link rel="prefetch" href="/assets/js/20.351ed211.js"><link rel="prefetch" href="/assets/js/21.e2ca7763.js"><link rel="prefetch" href="/assets/js/22.8db7a878.js"><link rel="prefetch" href="/assets/js/23.e51f5581.js"><link rel="prefetch" href="/assets/js/24.ee4d1ba6.js"><link rel="prefetch" href="/assets/js/25.95ab8947.js"><link rel="prefetch" href="/assets/js/26.10942abd.js"><link rel="prefetch" href="/assets/js/27.78f8142f.js"><link rel="prefetch" href="/assets/js/28.ab2474e2.js"><link rel="prefetch" href="/assets/js/3.f5570fde.js"><link rel="prefetch" href="/assets/js/30.89a3cde3.js"><link rel="prefetch" href="/assets/js/31.a6e686fa.js"><link rel="prefetch" href="/assets/js/32.d21edd17.js"><link rel="prefetch" href="/assets/js/33.e1d544cc.js"><link rel="prefetch" href="/assets/js/34.f4808895.js"><link rel="prefetch" href="/assets/js/35.d5ac07cd.js"><link rel="prefetch" href="/assets/js/36.d269b434.js"><link rel="prefetch" href="/assets/js/37.87aea43e.js"><link rel="prefetch" href="/assets/js/38.0161b3f6.js"><link rel="prefetch" href="/assets/js/39.fc44419d.js"><link rel="prefetch" href="/assets/js/4.3d7e1167.js"><link rel="prefetch" href="/assets/js/40.95a1a6ca.js"><link rel="prefetch" href="/assets/js/41.ad0e816e.js"><link rel="prefetch" href="/assets/js/42.db3cfaf5.js"><link rel="prefetch" href="/assets/js/43.96deb88f.js"><link rel="prefetch" href="/assets/js/44.61e9b248.js"><link rel="prefetch" href="/assets/js/45.1de81233.js"><link rel="prefetch" href="/assets/js/46.88ffa560.js"><link rel="prefetch" href="/assets/js/47.bd65416f.js"><link rel="prefetch" href="/assets/js/48.1b749e99.js"><link rel="prefetch" href="/assets/js/49.b2828af6.js"><link rel="prefetch" href="/assets/js/5.515e517f.js"><link rel="prefetch" href="/assets/js/50.dd142e4a.js"><link rel="prefetch" href="/assets/js/51.82bfd76d.js"><link rel="prefetch" href="/assets/js/52.fc23351a.js"><link rel="prefetch" href="/assets/js/53.a05272d6.js"><link rel="prefetch" href="/assets/js/54.39280cee.js"><link rel="prefetch" href="/assets/js/55.56e40469.js"><link rel="prefetch" href="/assets/js/56.cae7d426.js"><link rel="prefetch" href="/assets/js/57.9b2b4098.js"><link rel="prefetch" href="/assets/js/58.834b8fb8.js"><link rel="prefetch" href="/assets/js/59.5c1e8a9d.js"><link rel="prefetch" href="/assets/js/6.921e6e44.js"><link rel="prefetch" href="/assets/js/60.200ade4b.js"><link rel="prefetch" href="/assets/js/61.9379836a.js"><link rel="prefetch" href="/assets/js/62.40848567.js"><link rel="prefetch" href="/assets/js/63.476bf996.js"><link rel="prefetch" href="/assets/js/64.17f96d11.js"><link rel="prefetch" href="/assets/js/65.8e272f26.js"><link rel="prefetch" href="/assets/js/66.10ad73cf.js"><link rel="prefetch" href="/assets/js/67.08e28c6a.js"><link rel="prefetch" href="/assets/js/68.583ec300.js"><link rel="prefetch" href="/assets/js/69.98dc4570.js"><link rel="prefetch" href="/assets/js/7.fffb9950.js"><link rel="prefetch" href="/assets/js/70.1ba9cf53.js"><link rel="prefetch" href="/assets/js/71.6a8123f1.js"><link rel="prefetch" href="/assets/js/72.9fe20ff1.js"><link rel="prefetch" href="/assets/js/73.c999b3b1.js"><link rel="prefetch" href="/assets/js/74.a3b8a6e7.js"><link rel="prefetch" href="/assets/js/75.24ed1d97.js"><link rel="prefetch" href="/assets/js/76.a32dbcc9.js"><link rel="prefetch" href="/assets/js/77.1107860d.js"><link rel="prefetch" href="/assets/js/78.ff9e7714.js"><link rel="prefetch" href="/assets/js/79.36bb309c.js"><link rel="prefetch" href="/assets/js/80.862d6b37.js"><link rel="prefetch" href="/assets/js/81.9fa6b600.js"><link rel="prefetch" href="/assets/js/82.b1ea3357.js"><link rel="prefetch" href="/assets/js/83.63ad8445.js"><link rel="prefetch" href="/assets/js/84.2c0eafa1.js"><link rel="prefetch" href="/assets/js/85.77177c5f.js"><link rel="prefetch" href="/assets/js/86.20d53700.js"><link rel="prefetch" href="/assets/js/87.b7fb94e6.js"><link rel="prefetch" href="/assets/js/88.a28049b4.js"><link rel="prefetch" href="/assets/js/89.e8d78858.js"><link rel="prefetch" href="/assets/js/90.a941f077.js"><link rel="prefetch" href="/assets/js/91.d1de1fed.js"><link rel="prefetch" href="/assets/js/92.42e2a443.js"><link rel="prefetch" href="/assets/js/93.552b2465.js"><link rel="prefetch" href="/assets/js/94.757ca009.js"><link rel="prefetch" href="/assets/js/95.c1845811.js"><link rel="prefetch" href="/assets/js/96.87ffdf35.js"><link rel="prefetch" href="/assets/js/97.24d7a901.js"><link rel="prefetch" href="/assets/js/98.f738b83a.js"><link rel="prefetch" href="/assets/js/99.d7dbcd46.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d852a880.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a31c27c1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.png" alt="Commercio.network Documentation" class="logo"> <span class="site-name can-hide">Commercio.network Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Versions" class="dropdown-title"><span class="title">Versions</span> <span class="arrow down"></span></button> <button type="button" aria-label="Versions" class="mobile-dropdown-title"><span class="title">Versions</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  ver 3.0.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.2.0/" class="nav-link">
  ver 2.2.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.1.2/" class="nav-link">
  ver 2.1.2
</a></li></ul></div></div><div class="nav-item"><a href="https://commercio.network" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.gg/N7DxaDj5sW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://t.me/CommercioNetwork" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://twitter.com/commercionet?s=21&amp;t=8FTpg5f7kurZ1d7LOb9YXw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Versions" class="dropdown-title"><span class="title">Versions</span> <span class="arrow down"></span></button> <button type="button" aria-label="Versions" class="mobile-dropdown-title"><span class="title">Versions</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  ver 3.0.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.2.0/" class="nav-link">
  ver 2.2.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.1.2/" class="nav-link">
  ver 2.1.2
</a></li></ul></div></div><div class="nav-item"><a href="https://commercio.network" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.gg/N7DxaDj5sW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://t.me/CommercioNetwork" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://twitter.com/commercionet?s=21&amp;t=8FTpg5f7kurZ1d7LOb9YXw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Overview</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Running Nodes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodes/" aria-current="page" class="sidebar-link">Commercio.network overview</a></li><li><a href="/nodes/hardware-requirements.html" class="sidebar-link">Hardware requirements</a></li><li><a href="/nodes/full-node-installation.html" class="sidebar-link">Installing a full node</a></li><li><a href="/nodes/statesync-node-installation.html" class="sidebar-link">Installing a statesynced node</a></li><li><a href="/nodes/validator-node-installation.html" class="sidebar-link">Becoming a validator</a></li><li><a href="/nodes/validator-node-handling.html" class="sidebar-link">Handling a validator</a></li><li><a href="/nodes/validator-node-update.html" class="sidebar-link">Updating a validator</a></li><li><a href="/nodes/kms-installation.html" aria-current="page" class="active sidebar-link">KMS installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#general-concepts" class="sidebar-link">General concepts</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#hardware-requirements" class="sidebar-link">Hardware requirements</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#scenario" class="sidebar-link">Scenario</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#installation" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#yubihsm2-service-installation" class="sidebar-link">YubiHSM2 Service Installation</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#hsm-installation" class="sidebar-link">HSM Installation</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#key-generation" class="sidebar-link">Key generation</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#key-confirmation" class="sidebar-link">Key confirmation</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#config-the-service" class="sidebar-link">Config the service</a></li><li class="sidebar-sub-header"><a href="/nodes/kms-installation.html#config-the-validator-node" class="sidebar-link">Config the validator node</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API Developers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/app_developers/commercioapi-introduction.html" class="sidebar-link">Introduction to CommercioAPI</a></li><li><a href="/app_developers/commercioapi-authentication.html" class="sidebar-link">Authentication process</a></li><li><a href="/app_developers/commercioapi-wallet.html" class="sidebar-link">eID</a></li><li><a href="/app_developers/commercioapi-ekyc.html" class="sidebar-link">eKyc</a></li><li><a href="/app_developers/commercioapi-sharedoc.html" class="sidebar-link">eDelivery</a></li><li><a href="/app_developers/commercioapi-esign.html" class="sidebar-link">eSign</a></li><li><a href="/app_developers/commercioapi-flow_examples.html" class="sidebar-link">Flows examples : Api usage</a></li><li><a href="/app_developers/commercioapi-surcharge.html" class="sidebar-link">Surcharge POST options</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/modules/" class="sidebar-heading clickable"><span>Custom Modules</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/modules/government/" class="sidebar-heading clickable open"><span>Government</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/modules/government/" class="sidebar-link">Concepts</a></li><li><a href="/modules/government/01_state.html" class="sidebar-link">State</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/modules/did/" class="sidebar-heading clickable"><span>Did</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/modules/documents/" class="sidebar-heading clickable"><span>Documents</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/modules/commerciomint/" class="sidebar-heading clickable"><span>CommercioMint</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/modules/commerciokyc/" class="sidebar-heading clickable"><span>CommercioKYC</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/modules/vbr/" class="sidebar-heading clickable"><span>Vbr</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ver 2.2.0</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ver 2.1.2</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="kms-with-yubihsm2"><a href="#kms-with-yubihsm2" class="header-anchor">#</a> KMS with YubiHSM2</h1> <h2 id="general-concepts"><a href="#general-concepts" class="header-anchor">#</a> General concepts</h2> <h2 id="hardware-requirements"><a href="#hardware-requirements" class="header-anchor">#</a> Hardware requirements</h2> <ul><li>SO: Ubuntu 18.04 (64-bit) or later  (preferably LTS version)</li> <li>Minimum amount of RAM: 4Gb</li> <li>Available disk space: 100 Gb</li> <li>Connect to the your validator node in private network (LAN or VPN)</li></ul> <h2 id="scenario"><a href="#scenario" class="header-anchor">#</a> Scenario</h2> <p><img src="/assets/img/kms_validator_schema.a6304b37.png" alt="Kms Validator connection"></p> <p>For simplicity in the explanation we can assume that we have a vpn that connects the Data Center with the Cloud with the ip class</p> <ul><li><strong>KMS</strong>: <code>10.1.1.1</code></li> <li><strong>Validator node</strong>: <code>10.1.1.254</code></li></ul> <p>The protection is at the port opening level and it's the following</p> <ul><li><strong>KMS</strong>: no open ports, only access to the lan or vpn towards the Validator node</li> <li><strong>Validator node</strong>:
<ul><li>port <code>26656</code> open on all ip</li> <li>port <code>26658</code> open on all ip but with access limited to the KMS</li></ul></li></ul> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>Upgrade your ubuntu system</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">su</span> -
<span class="token function">apt</span> update
<span class="token function">apt</span> upgrade <span class="token parameter variable">-y</span>
</code></pre></div><p>Create a new user to run the KMS server and reboot the system</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> /data_tmkms
<span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-d</span> /data_tmkms/tmkms <span class="token parameter variable">-G</span> tmkms <span class="token parameter variable">-s</span> /bin/bash
<span class="token builtin class-name">echo</span> <span class="token string">'SUBSYSTEMS==&quot;usb&quot;, ATTRS{product}==&quot;YubiHSM&quot;, GROUP==&quot;tmkms&quot;'</span> <span class="token operator">&gt;&gt;</span> /etc/udev/rules.d/10-yubihsm.rules
<span class="token function">reboot</span>
</code></pre></div><p><strong>Please note</strong>: it might be necessary to restart the server several times to apply the rules</p> <p>Install the components</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">su</span> -
<span class="token function">apt</span> <span class="token function">install</span> gcc <span class="token function">git</span> libusb-1.0-0-dev pkg-config <span class="token parameter variable">-y</span>
</code></pre></div><p>Install rust: language for compiling TmKms</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">su</span> - tmkms
<span class="token function">curl</span> <span class="token parameter variable">--proto</span> <span class="token string">'=https'</span> <span class="token parameter variable">--tlsv1.2</span> <span class="token parameter variable">-sSf</span> https://sh.rustup.rs <span class="token operator">|</span> <span class="token function">sh</span>
<span class="token builtin class-name">source</span> <span class="token environment constant">$HOME</span>/.cargo/env

</code></pre></div><p>Install TmKms</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>
<span class="token function">git</span> clone https://github.com/tendermint/kms.git
<span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>/kms
<span class="token function">cargo</span> <span class="token function">install</span> tmkms <span class="token parameter variable">--features</span><span class="token operator">=</span>yubihsm <span class="token parameter variable">--locked</span> <span class="token parameter variable">--force</span> <span class="token parameter variable">--version</span><span class="token operator">=</span><span class="token number">0.10</span>.0
</code></pre></div><p>Check the installation version</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tmkms version
</code></pre></div><h3 id="yubihsm2-service-installation"><a href="#yubihsm2-service-installation" class="header-anchor">#</a> YubiHSM2 Service Installation</h3> <p>The YubiHSM2 is a hardware device that must be connected to the server via USB. It is also necessary to install additional tools of the yubihsm in order to manage the connection as a service and not directly on usb.</p> <p>Install yubico utilities. Search in <a href="https://developers.yubico.com/YubiHSM2/Releases/" target="_blank" rel="noopener noreferrer">https://developers.yubico.com/YubiHSM2/Releases/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> the right version for your system</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">su</span> -
<span class="token builtin class-name">cd</span> /tmp
<span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token string">&quot;yubihsm2-sdk-2019-12-ubuntu1804-amd64.tar.gz&quot;</span>
<span class="token function">wget</span> <span class="token string">&quot;https://developers.yubico.com/YubiHSM2/Releases/<span class="token variable">$VERSION</span>&quot;</span>
<span class="token function">tar</span> zxf <span class="token variable">$VERSION</span> 
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ./yubihsm2-sdk/*.deb
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$VERSION</span>
</code></pre></div><p>Activate the service</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">tee</span> /etc/systemd/system/yubihsm-connector.service <span class="token operator">&gt;</span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOF 
[Unit]
Description=YubiHSM connector
Documentation=https://developers.yubico.com/YubiHSM2/Component_Reference/yubihsm-connector/
After=network-online.target
Wants=network-online.target systemd-networkd-wait-online.service

[Service]
Restart=on-abnormal
User=tmkms
Group=tmkms
ExecStart=/usr/bin/yubihsm-connector -c /etc/yubihsm-connector.yaml
PrivateTmp=true
ProtectHome=true
ProtectSystem=full

[Install]
WantedBy=multi-user.target
EOF</span>

systemctl <span class="token builtin class-name">enable</span> yubihsm-connector.service
systemctl start yubihsm-connector.service
</code></pre></div><p>Check the service status and the listening port</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl status yubihsm-connector.service
ss <span class="token parameter variable">-tlpn</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">12345</span>
</code></pre></div><h3 id="hsm-installation"><a href="#hsm-installation" class="header-anchor">#</a> HSM Installation</h3> <p>Insert yubiHSM 2 into the usb slot. If the device has been used previously, reset it by holding down the metal ring for more than 3 seconds when the device is inserted.</p> <p>You need to create a configuration file tmkms.toml containing the information of the validator node to which the Kms must connect.</p> <p>You can find an example file below.<br>
Create the folder for the configuration</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token environment constant">$HOME</span>/kms/commercio
<span class="token function">touch</span> <span class="token environment constant">$HOME</span>/kms/commercio/tmkms.toml

</code></pre></div><p>When using the <code>tmkms</code> user, the value of the <code>$HOME</code> variable is <code>/data_tmkms/tmkms</code>.</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token table class-name">chain</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token key property">id</span> <span class="token punctuation">=</span> <span class="token string">&quot;commercio-3&quot;</span>
<span class="token key property">key_format</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">type</span> <span class="token punctuation">=</span> <span class="token string">&quot;bech32&quot;</span><span class="token punctuation">,</span> <span class="token key property">account_key_prefix</span> <span class="token punctuation">=</span> <span class="token string">&quot;did:com:&quot;</span><span class="token punctuation">,</span> <span class="token key property">consensus_key_prefix</span> <span class="token punctuation">=</span> <span class="token string">&quot;did:com:valconspub&quot;</span> <span class="token punctuation">}</span>
<span class="token key property">state_file</span> <span class="token punctuation">=</span> <span class="token string">&quot;/data_tmkms/tmkms/kms/commercio/commercio_priv_validator_state.json&quot;</span>

<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token table class-name">validator</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token key property">addr</span> <span class="token punctuation">=</span> <span class="token string">&quot;tcp://10.1.1.254:26658&quot;</span> <span class="token comment"># The ip of Validator Node</span>
<span class="token key property">chain_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;commercio-3&quot;</span>
<span class="token key property">reconnect</span> <span class="token punctuation">=</span> <span class="token boolean">true</span> <span class="token comment"># true is the default</span>
<span class="token key property">secret_key</span> <span class="token punctuation">=</span> <span class="token string">&quot;/data_tmkms/tmkms/kms/commercio/secret_connection.key&quot;</span>

<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token table class-name">providers.yubihsm</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token key property">adapter</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">type</span> <span class="token punctuation">=</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token key property">addr</span> <span class="token punctuation">=</span> <span class="token string">&quot;tcp://127.0.0.1:12345&quot;</span> <span class="token punctuation">}</span>
<span class="token key property">auth</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">key</span> <span class="token punctuation">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token key property">password_file</span> <span class="token punctuation">=</span> <span class="token string">&quot;/data_tmkms/tmkms/kms/password&quot;</span> <span class="token punctuation">}</span> <span class="token comment"># It is possible to enter the password directly using the password parameter instead of password_file</span>
<span class="token key property">keys</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token key property">chain_ids</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;commercio-3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token key property">key</span> <span class="token punctuation">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token key property">serial_number</span> <span class="token punctuation">=</span> <span class="token string">&quot;9876543210&quot;</span> <span class="token comment"># identify serial number of a specific YubiHSM to connect to</span>
</code></pre></div><p>For the creation of the file you need to have the following data</p> <ul><li>Chain-id is the identifier of the chain for which the node is being configured. In the case of mainnet it is <code>commercio-3</code></li> <li>Prefix of public addresses of the chain: in the case of commercio it is <code>did:com:</code></li> <li>Prefix of the public addresses of the nodes: in the case of commercio it is <code>did:com:valconspub</code></li> <li>Address within the lan or vpn of the validator node: for simplicity we have assumed to have the address <code>10.1.1.254</code></li> <li>The password of our HSM device: initially the password is <strong>&quot;password&quot;</strong></li> <li>The id of the key to use of the HSM: for the single configuration is <code>1</code></li> <li>The serial Number of our device: generally it is what is indicated on the label of the YubiHSM2. They must be 10 digits. For the missing digits add zeros at the beginning</li></ul> <p>Create the file <code>/data_tmkms/tmkms/kms/password</code> and enter the password &quot;password&quot; inside it</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">printf</span> <span class="token string">&quot;password&quot;</span> <span class="token operator">&gt;</span> /data_tmkms/tmkms/kms/password
</code></pre></div><h4 id="hsm-reset"><a href="#hsm-reset" class="header-anchor">#</a> HSM Reset</h4> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>⚠️ This procedure will do a complete reset of the device. It must not be done for a possible second installation of another node that uses the same hsm</p></div> <div class="language-bash extra-class"><pre class="language-bash"><code>tmkms yubihsm setup <span class="token parameter variable">-c</span> /data_tmkms/tmkms/kms/commercio/tmkms.toml
</code></pre></div><p>An output of this type should appear</p> <div class="language- extra-class"><pre class="language-text"><code>This process will *ERASE* the configured YubiHSM2 and reinitialize it:

- YubiHSM serial: 9876543210

Authentication keys with the following IDs and passwords will be created:

- key 0x0001: admin:

    double section release consider diet pilot flip shell mother alone what fantasy
    much answer lottery crew nut reopen stereo square popular addict just animal

- authkey 0x0002 [operator]:  kms-operator-password-1k02vtxh4ggxct5tngncc33rk9yy5yjhk
- authkey 0x0003 [auditor]:   kms-auditor-password-1s0ynq69ezavnqgq84p0rkhxvkqm54ks9
- authkey 0x0004 [validator]: kms-validator-password-1x4anf3n8vqkzm0klrwljhcx72sankcw0
- wrapkey 0x0001 [primary]:   21a6ca8cfd5dbe9c26320b5c4935ff1e63b9ab54e2dfe24f66677aba8852be13

*** Are you SURE you want erase and reinitialize this HSM? (y/N): y
21:08:09 [WARN] factory resetting HSM device! all data will be lost!

21:08:11 [WARN] deleting temporary setup authentication key from slot 65534
     Success reinitialized YubiHSM (serial: 9876543210)
</code></pre></div><p>Confirm when asked to reinitialize the device (in bold in the output). Take note of the output, especially the 24 words provided as a new password (also in bold in the output above).
Save the new password of the file</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">printf</span> <span class="token string">&quot;double section release consider diet pilot flip shell mother alone what fantasy much answer lottery crew nut reopen stereo square popular addict just animal&quot;</span> <span class="token operator">&gt;</span>/data_tmkms/tmkms/kms/password
</code></pre></div><p><strong>NB</strong>: The password is provided on two separate lines but must be set in the file on a single line</p> <h3 id="key-generation"><a href="#key-generation" class="header-anchor">#</a> Key generation</h3> <p>The keys are generated using the tmkms command. The command is structured as follows</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tmkms yubihsm keys generate <span class="token number">1</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-b</span> steakz4u-validator-key.enc <span class="token punctuation">\</span>
  <span class="token parameter variable">-c</span> /data_tmkms/tmkms/kms/commercio/tmkms.toml
</code></pre></div><p>Launch the command to produce the new key. The <code>-b</code> option allows you to save the key</p> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>⚠️ The steakz4u-validator-key.enc backup file must be immediately transferred to the multiple off-line supports and secured. If it is lost, the key generated at this time can no longer be replicated.</p></div> <p>In the case of a new installation of the node, the key must be imported into the HSM. To do this, use the following command</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tmkms yubihsm keys <span class="token function">import</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-t</span> json <span class="token punctuation">\</span>
  <span class="token parameter variable">-i</span> <span class="token number">1</span> priv_validator.json <span class="token punctuation">\</span>
  <span class="token parameter variable">-c</span> /data_tmkms/tmkms/kms/commercio/tmkms.toml
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>⚠️ The priv_validator.json backup file must be immediately transferred to the multiple, off-line, encrypted and secured supports. If it is lost, the key generated at this time can no longer be replicated.</p></div> <h3 id="key-confirmation"><a href="#key-confirmation" class="header-anchor">#</a> Key confirmation</h3> <p>To confirm that the keys are present and configured in the HSM use the command</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tmkms yubihsm keys list  <span class="token parameter variable">-c</span> /data_tmkms/tmkms/kms/commercio/tmkms.toml
</code></pre></div><p>Should be presented an output like the following</p> <div class="language- extra-class"><pre class="language-text"><code>Listing keys in YubiHSM #9876543210:
- 0x0001: did:com:valconspub1zcjduepq592mn6xucyqvfrvjegruhnx55cruffkrfq0rryu809fzkgwg684qmetxxs
</code></pre></div><p><code>did:com:valconspub1zcjduepq592mn6xucyqvfrvjegruhnx55cruffkrfq0rryu809fzkgwg684qmetxxs</code> is the public key of the validator node. This key will be needed to perform the validator node creation transaction</p> <p>At this point the KMS can be connected to the Node</p> <p>Test the KMS service</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tmkms start <span class="token parameter variable">-c</span> /data_tmkms/tmkms/kms/commercio/tmkms.toml
</code></pre></div><p>An output like this should appear.</p> <div class="language- extra-class"><pre class="language-text"><code>Mar 05 12:20:26.781  INFO tmkms::commands::start: tmkms 0.10.0 starting up…
Mar 05 12:20:27.280  INFO tmkms::keyring: [keyring:yubihsm] added consensus key did:com:valconspub1zcjduepq592mn6xucyqvfrvjegruhnx55cruffkrfq0rryu809fzkgwg684qmetxxs
Mar 05 12:20:27.280  INFO tmkms::connection::tcp: KMS node ID: 4248B5C7755600D694C47ECEA710A2DAB743AA38
Mar 05 12:20:58.682 ERROR tmkms::client: [commercio-3@tcp://10.1.1.254:26658] I/O error: Connection timed out (os error 110)
Mar 05 12:20:59.683  INFO tmkms::connection::tcp: KMS node ID: 4248B5C7755600D694C47ECEA710A2DAB743AA38
...
</code></pre></div><p>If the output reports errors other than simple connection failure then the installation should be checked.
<strong>Please note</strong>: The connection attempt fails because we have not yet configured the node to which the kms should connect.
crtl+c to abort the process.</p> <h3 id="config-the-service"><a href="#config-the-service" class="header-anchor">#</a> Config the service</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">tee</span> /etc/systemd/system/tmkms.service <span class="token operator">&gt;</span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOF 
[Unit]
Description=Commercio tmkms
After=network.target

[Service]
User=tmkms
WorkingDirectory=/data_tmkms/tmkms/.cargo/bin
ExecStart=/data_tmkms/tmkms/.cargo/bin/tmkms start -c /data_tmkms/tmkms/kms/commercio/tmkms.toml
Restart=always
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=tmkms
RestartSec=3
LimitNOFILE=4096

[Install]
WantedBy=multi-user.target
EOF</span>

<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> tmkms
<span class="token function">sudo</span> systemctl start tmkms
</code></pre></div><h3 id="config-the-validator-node"><a href="#config-the-validator-node" class="header-anchor">#</a> Config the validator node</h3> <p>To allow the validator node to access the private key, the <code>.commercionetworkd/config/config.toml</code> file must be modified.
Edit the parameter by putting the ip of the validator node</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token key property">priv_validator_laddr</span> <span class="token punctuation">=</span> <span class="token string">&quot;tcp://10.1.1.254:26658&quot;</span>
</code></pre></div><p>Restart the service of the node</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl restart commercionetworkd
</code></pre></div><p>Check the output of the kms. Logs should vary in this way</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Jan <span class="token number">11</span> 09:23:14.389  INFO tmkms::session: <span class="token punctuation">[</span>commercio-3@tcp://10.1.1.254:26658<span class="token punctuation">]</span> connected to validator successfully
Jan <span class="token number">11</span> 09:23:14.389  WARN tmkms::session: <span class="token punctuation">[</span>commercio-3<span class="token punctuation">]</span> tcp:/10.1.1.254:26658: unverified validator peer ID<span class="token operator">!</span> <span class="token punctuation">(</span>A312D8F64C9FC71A1A947C377F64B7302C951361<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/commercionetwork/commercionetwork/edit/master/docs/nodes/kms-installation.md" target="_blank" rel="noopener noreferrer">Edit this page on Github</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/15/2024, 11:28:54 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nodes/validator-node-update.html" class="prev">
        Updating a validator
      </a></span> <span class="next"><a href="/app_developers/commercioapi-introduction.html">
        Introduction to CommercioAPI
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.25897520.js" defer></script><script src="/assets/js/2.ac32ef9e.js" defer></script><script src="/assets/js/1.da52573b.js" defer></script><script src="/assets/js/29.c7d75f04.js" defer></script>
  </body>
</html>
